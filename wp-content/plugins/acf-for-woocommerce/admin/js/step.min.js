"use strict";function cpb_get_elements(){return[{label:"Text Field",id:"text_field",icon:"form",category:"Basic",name:"",settings:{name:{category:"",type:"input",value:"",label:"Field name",placeholder:"Field name in form submit",description:"Lorem ipsum dolor sit amet, consectetur adipisicing elit."},label:{type:"input",value:"",label:"Label"},placeholder:{type:"input",value:"",label:"Placeholder"},default:{type:"input",value:"",label:"Default value"},type:{type:"radio_button",value:"text",label:"Type",options:{text:"Text field",email:"Email",number:"Number",password:"Password"}}}},{label:"Radio",id:"radio",category:"Basic",icon:"check-circle",name:"",settings:{name:{type:"input",label:"Field name",placeholder:"Field name in form submit"},label:{type:"input",value:"",label:"Label"},default:{type:"input",value:"",label:"Default value"},options:{label:"Options",type:"textarea",value:"",placeholder:"value : key\r\nvalue : key"}}},{label:"Checkbox",id:"checkbox",category:"Basic",icon:"check-square",name:"",settings:{name:{type:"input",label:"Field name",placeholder:"Field name in form submit"},label:{type:"input",value:"",label:"Label"},default:{type:"input",value:"",label:"Default value"},options:{label:"Options",type:"textarea",value:"",placeholder:"value : key\r\nvalue : key"}}},{label:"Select Box",id:"select",category:"Basic",icon:"menu-unfold",name:"",settings:{name:{type:"input",label:"Field name",placeholder:"Field name in form submit"},label:{type:"input",value:"",label:"Label"},default:{type:"input",value:"",label:"Default value"},options:{label:"Options",type:"textarea",value:"",placeholder:"value : key\r\nvalue : key"}}},{label:"Button",id:"button",category:"Basic",icon:"border",name:"",settings:{name:{type:"input",label:"Field name",placeholder:"Field name in form submit"},label:{type:"input",value:"",label:"Label"},type:{type:"radio",value:"",label:"Type",options:{submit:"Submit",button:"Button",reset:"Reset"}}}}]}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cpb={add_filter:function(e,n){"object"!=_typeof(window.cpb_builder)&&(window.cpb_builder=[]),"object"!=_typeof(window.cpb_builder[e])&&(window.cpb_builder[e]=[]),window.cpb_builder[e].push(n)},apply_filters:function(e,n){return"object"==_typeof(window.cpb_builder)&&"object"==_typeof(window.cpb_builder[e])&&window.cpb_builder[e].map(function(e){"function"==typeof e&&(n=e(n))}),n}};Vue.component("cp-row",{props:[],template:"\n      \n    "});var cpArrayFuncs={deleteByIndex:function(e,n){return e.splice(n,1)}};Vue.directive("cpbresizecol",{inserted:function(e,n){void 0===window.cpbuilder&&(window.cpbuilder={}),$(e).addClass("cpbresizecol"),window.cpbuilder.response_mode=n.value.mode,$(e).on("mousedown",function(){window.cpbuilder.resize_el=$(e).closest(".cpb-col"),window.cpbuilder.resize_vl=n.value.col}),"added"!=window.cpbuilder.resize_fn_remove&&(window.cpbuilder.resize_fn_remove="added",$(document).on("mouseup",function(){window.cpbuilder.resize_el=!1,window.cpbuilder.resize_vl=!1})),"added"!=window.cpbuilder.resize_fn_handle&&(window.cpbuilder.resize_fn_handle="added",$(document).on("mousemove",function(e){if(void 0!==window.cpbuilder.resize_el&&0!=window.cpbuilder.resize_el){var n=window.cpbuilder.resize_el.closest(".cpb-row"),t=window.cpbuilder.resize_el.offset().left,o=n.width()/12,l=e.pageX-t;(l=Math.ceil(l/o))<=1&&(l=1);var a=window.cpbuilder.response_mode;window.cpbuilder.resize_vl.width[a]=l}}))},componentUpdated:function(e,n){window.cpbuilder.response_mode=n.value.mode,$(e).on("mousedown",function(){window.cpbuilder.resize_el=$(e).closest(".cpb-col"),window.cpbuilder.resize_vl=n.value.col})}}),Vue.component("cpb-popup-setting",{template:'\n        <div>\n            <a-tabs v-model="activeKey">\n                <a-tab-pane v-for="tab, indexLoop in getTabs(current_element.settings)" :tab="tab" :key="tab">\n                    <div class="cpb-row-settings" v-if="indexLoop==0">\n                        <div class="ant-form-item ant-form-item-with-help">\n                            <div class="ant-form-item-label">\n                                <label title="Field name">Field name</label>\n                            </div> \n                            <div class="ant-form-item-control-wrapper">\n                                <div class="ant-form-item-control has-feedback ">\n                                    <div class="ant-form-item-children">\n                                        <input placeholder="" v-model="current_element.user_input" type="text" id="" class="ant-input">                            \n                                    </div>\n                                    <i class="cpb-text-error">{{ current_element.error_message }}</i>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="cpb-row-settings" v-for="setting, setting_key in current_element.settings">\n                        <div v-if="setting.category == tab" class="ant-form-item ant-form-item-with-help" :class="\'cpb-element-\' + setting_key">\n                            <row-settings :root="root" :element="setting" :element_key="setting_key" \n                                @onRowNumberChanged="rowNumberHandler"\n                                @onColumnNumberChanged="columnNumberHandler"></row-settings>\n                        </div> \n                    </div>\n                </a-tab-pane>\n                \n                <a-tab-pane tab="Advance" key="Advance" v-if="current_element.type != \'row\' && hideAdvance == false">\n                    <div class="cpb-conditional-logic" style="margin-bottom: 16px">\n                        <div class="ant-form-item-label">\n                            <label>Show this field if</label>\n                        </div>\n                        <div v-for="(or, orIndex) in current_element.condition_settings.or" :key="orIndex">\n                            <a-row :gutter="16" v-for="(condition, andIndex) in or.and" :key="andIndex" style="padding: 8px 0;">   \n                                <a-col :span="7">\n                                    <a-select style="width: 100%;" v-model="condition.target">\n                                        <a-select-option v-for="element in getElements()" :value="element.name" :key="element.name">\n                                            {{element.user_input}}\n                                        </a-select-option>\n                                    </a-select>\n                                </a-col>\n                                <a-col :span="5">\n                                    <a-select style="width: 100%;" defaultValue="!=empty" v-model="condition.condition">\n                                        <a-select-option value="!=empty">Has any value</a-select-option>\n                                        <a-select-option value="==empty">Has no value</a-select-option>\n                                        <a-select-option value="==">Value is equal to</a-select-option>\n                                        <a-select-option value="!=">Value is not equal to</a-select-option>\n                                        <a-select-option value="==pattern">Value matches pattern</a-select-option>\n                                        <a-select-option value="==contains">Value contains</a-select-option>\n                                    </a-select>\n                                </a-col>\n                                <a-col :span="7">\n                                    <a-input v-model="condition.value" :disabled="condition.condition == \'!=empty\' || condition.condition == \'==empty\'"/>\n                                </a-col>\n                                <a-col :span="3">\n                                    <a-button style="width: 100%;" @click.prevent="addAndCondition(orIndex)">And</a-button>\n                                </a-col>\n                                <a-col :span="2">\n                                    <a-button shape="circle" icon="minus" @click.prevent="or.and.splice(andIndex, 1)"/>\n                                </a-col>\n                            </a-row>\n                            \n                            <div class="ant-form-item-label">\n                                <label title="Field name">Or</label>\n                            </div>      \n                        </div>\n                        <a-row :gutter="16">\n                            <a-col :span="24">\n                                <a-button @click.prevent="addOrCondition()">Add rule group</a-button>\n                            </a-col>\n                        </a-row>\n                    </div>\n                    <div class="cpb-pricing-field" style="padding: 8px 0px" v-if="isAllowedElement()">\n                        <a-row :gutter="16" style="margin-bottom: 10px">\n                            <a-col :span="2">\n                                <a-switch @change=\'onChange\' :checked="checked" />\n                            </a-col>\n                            <a-col :span="4" class="gutter-row" style="margin-left: 10px">\n                                <h4>Pricing fields</h4>\n                            </a-col>\n                        </a-row>\n                        <div v-if="checked">\n                            <a-row :gutter="16" v-for="(opt, optindex) in getKeyValuePairsOfOptions" :key="optindex" style="margin-bottom: 10px">\n                                <a-col :span="12" class="gutter-row">\n                                    <a-input v-model="current_element.settings.options.pricing[optindex].value" addonBefore="Value" disabled />\n                                </a-col>\n                                <a-col :span="12" class="gutter-row">\n                                    <a-input v-model="current_element.settings.options.pricing[optindex].price" addonBefore="Price" type="number" />\n                                </a-col>\n                            </a-row>  \n                        </div>\n                    </div>\n                    \n                    \n                </a-tab-pane>\n                \n            </a-tabs>\n        </div>\n    ',data:function(){return{error_message:"",checked:!1,activeKey:"General"}},props:["root","current_element","named","opened","hideAdvance"],watch:{"current_element.name":function(){var n=this;n.current_element.error_message="",Object.keys(n.named).some(function(e){if(""!=n.named[e]&&n.current_element.hash!=e&&n.named[e]==n.current_element.name)return!(n.current_element.error_message="Name is existed!")})},"current_element.settings.display_format.value":function(e){if(null!=this.current_element.settings.default){var n=this.current_element.settings.default.format,t=""===this.current_element.settings.default.value?moment().format(n):this.current_element.settings.default.value;this.current_element.settings.default.format=e,this.current_element.settings.default.value=moment(t,n).format(e)}},current_element:function(){this.isEnablePricingFields()},opened:function(){this.activeKey="General"}},methods:{getTabs:function(t){if("object"==(void 0===t?"undefined":_typeof(t))){var o=[];return Object.keys(t).map(function(e){var n="General";void 0!==t[e].category&&""!=t[e].category&&(n=t[e].category),o.indexOf(n)<0&&o.push(n)}),o}return[]},getElements:function(){var n=this,e=_.chain(this.root).pluck("cols").flatten().pluck("elements").flatten().value();return _.filter(e,function(e){return e.name!=n.current_element.name&&("text_field"===e.id||"radio"===e.id||"select"===e.id||"checkbox"===e.id||"text-area"===e.id)})},addAndCondition:function(e){this.current_element.condition_settings.or[e].and.push({target:"",condition:"!=empty",value:""})},addOrCondition:function(){var e=this.current_element.condition_settings.or.length;this.current_element.condition_settings.or.push({and:[]}),this.addAndCondition(e)},rowNumberHandler:function(e){null!=e&&""!==e||(e=0);var n=this.current_element.settings.layout.rows,t=0===n.length?this.current_element.settings.cols_numb.value:n[0].cols.length,o=0===n.length?[]:n[0].cols;this.$emit("onRowChanged",{rows:this.current_element.settings.layout.rows,number_of_rows:e,number_of_cols:t,default_value_cols:o})},columnNumberHandler:function(e){(null!=e&&""!==e||(e=0),0!==this.current_element.settings.layout.rows.length)&&(this.current_element.settings.layout.rows[0].cols.length!==e&&(this.current_element.settings.layout.rows[0].cols=[],this.$emit("onColumnChanged",{rows:this.current_element.settings.layout.rows,value:e})))},onChange:function(e){this.checked=e},isAllowedElement:function(){return"checkbox"===this.current_element.id||"radio"===this.current_element.id||"select"===this.current_element.id},isEnablePricingFields:function(){if(null==this.current_element.settings.options)return!1;this.checked=0<this.current_element.settings.options.pricing.length}},computed:{getKeyValuePairsOfOptions:function(){if(0<this.current_element.settings.options.pricing.length)return this.current_element.settings.options.pricing;var e=this.current_element.settings.options.value.split("\n").map(function(e){return{value:e,price:""}});return this.current_element.settings.options.pricing=e}},mounted:function(){this.isEnablePricingFields()}}),Vue.component("cpb-input-validation",{props:["element_type","json_object"],template:'\n        <div style="margin-top: 10px">\n            <label>{{buildPlaceholer(element_type)}}</label>\n            <input  v-on:change="validationChange" v-if="element_type != \'password\'" type="text" class="ant-input" style="margin-top: 10px">\n        </div>\n    ',data:function(){return{}},methods:{buildPlaceholer:function(e){switch(e){case"text":return"Max characters";case"email":return"Please input whitelist email";case"number":return"Max number"}},validationChange:function(e){this.$emit("onValidationChange",{type:this.element_type,value:e.target.value})}}}),Vue.component("row-settings",{template:'<div>\n        <div class="ant-form-item-label">\n            <label :title="element.label" class="">{{ element.label }}</label>\n        </div>\n\n        <div class="ant-form-item-control-wrapper">\n\n            <div class="ant-form-item-control has-feedback ">\n                \n                <span v-if="element.type == \'input\'" class="ant-form-item-children">\n                    <input :placeholder="element.placeholder" :disabled="element.disabled" v-model="element.value" :type="element.constraint" id="" class="ant-input">\n                </span>\n\n                <span v-if="element.type == \'textarea\'"  class="ant-form-item-children">\n                    <a-textarea :autosize="true" :placeholder="element.placeholder" v-model="element.value"/>\n                </span>\n\n                <span v-if="element.type == \'radio\'"  class="ant-form-item-children">\n                    <a-radio-group v-model="element.value">\n                        <a-radio v-for="otp, id in element.options" :key="id" style="width: 100%" :value="id">{{ otp }}</a-radio>\n                    </a-radio-group>\n                </span>\n                \n                <span v-if="element.type == \'switch\'"  class="ant-form-item-children">\n                    <a-switch v-model="element.value" />\n                </span>\n\n                <div v-if="element.type == \'radio_button\'"  class="ant-form-item-children solid">\n                    <a-radio-group v-model="element.value" buttonStyle="solid">\n                        <a-radio-button v-for="otp, id in element.options" :key="id" :value="id">{{ otp }}</a-radio-button>\n                    </a-radio-group>\n                    <cpb-input-validation @onValidationChange="onValidationChange" v-if="showValidation(element, \'validation\')" :element_type=\'element.value\' :json_object=\'element\'/>\n                </div>\n                \n                <span v-if="element.type == \'picker\'">\n                    <a-date-picker :defaultValue="defaultValueOfDatePicker" @ok="onSelectDateTime" showTime :format="element.format" style="width: 100%" />\n                </span>\n                \n                <span v-if="element.type == \'select\'"  class="ant-form-item-children">\n                    <a-select @select="onSelected"\n                        showSearch\n                        placeholder="Select a option"\n                        style="width: 100%"\n                    >\n                        <a-select-option v-for="otp, id in element.options" :key="id" :value="id">{{ otp }}</a-select-option>\n                    </a-select>\n                </span>\n\n                <span v-if="element.type == \'cascader\'"  class="ant-form-item-children">\n                    <a-cascader \n                    style="width: 100%"\n                    v-model="element.value"\n                    :options="element.options" changeOnSelect />\n                </span>\n                \n                <span v-if="element.type == \'multiple_input\'" >\n                    <a-row :gutter="16">\n                        <a-col class="gutter-row" v-for="(item, index) in element.values" :key="index" :span="Math.floor(24 / element.values.length)">\n                            <a-input :addonBefore="item.prefix" :addonAfter="item.suffix" v-model="item.value" type="text" id="" />\n                        </a-col>\n                    </a-row>\n                </span>\n                \n                <span v-if="element.isCustomEnabled == true" class="ant-form-item-children">\n                    <div class="ant-form-item-label">\n                        <label :title="element.label" class="">Custom for {{element.label}}</label>\n                    </div>\n                    <input :placeholder="element.placeholder" v-model="element.value" type="text" id="" class="ant-input">\n                </span>\n\n                <i v-if="element.description != \'\'" class="ant-form-explain">{{ element.description }}</i>\n            </div>\n        </div>\n    </div>\n    ',data:function(){return{data_type:""}},props:["root","element","element_key"],watch:{element:{handler:function(e){"rows_numb"===this.element_key&&this.$emit("onRowNumberChanged",e.value),"cols_numb"===this.element_key&&this.$emit("onColumnNumberChanged",e.value)},deep:!0}},methods:{showValidation:function(e,n){return Object.keys(e).includes(n)},onValidationChange:function(e){switch(e.type){case"text":return this.element.validation.limit=e.value;case"email":return this.element.validation.whitelist.push(e.value);case"number":return this.element.validation.limit=e.value}},onSelectDateTime:function(e){this.element.value=e.format(this.element.format)},onSelected:function(e){"custom"===e?this.element.isCustomEnabled=!0:(this.element.value=this.element.options[e],this.element.isCustomEnabled=!1),this.element.options.hasOwnProperty("custom")&&(this.element.value=this.element.options[e])}},computed:{moment:function(e){function n(){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}(function(){var e=moment();return"picker"===this.element.type&&(this.element.value=e.format(this.element.format)),e}),defaultValueOfDatePicker:function(){return""===this.element.value?moment():moment(this.element.value,this.element.format)}},mounted:function(){}});cpArrayFuncs={deleteByIndex:function(e,n){return e.splice(n,1)}};Vue.component("cpb-repeater",{template:'\n        <div class="repeater-wrapper">\n            <div class="cpb-row" v-for="r, indexrow in element.layout.rows" style="margin: 0 5px 0 5px !important;">\n                <div class="cpb-col" :class="getClassCol(col)" v-for="col, indexcol in r.cols">\n                    <div class="cpb-entry">\n                        <draggable class="list-group" :list="col.elements" group="elements_in_col">\n                            \n                            <div class="cpb-element-selected"  v-for="element, index in col.elements" :key="element.name + index">\n                                <a-button class="cpb-btn-component"  :icon="element.icon" block>\n                                    <b>{{ element.label }} </b>\n                                </a-button>\n                                <div class="cpb-com-tools">\n                                    <a @click.prevent="openSettingField(element)" class="cpb-icon-settings">Cài đặt</a>\n                                    <a @click.prevent="deleteElement(col.elements, index)" class="cpb-icon-delete"> Xoá</a>\n                                </div>\n                            </div>\n                        </draggable>\n                        <button v-if="isShowAddElementButton(col)" class="cpb-add-element" @click.prevent="addElement(col)">+ Add Element</button>\n                        <div class="cpb-tool-col">\n                            <button class="cpb-delete-col" @click.prevent="deleteCol(r.cols, indexcol, indexrow)">Delete this Col</button>\n                            <button class="cpb-add-element mini" @click.prevent="addElement(col)">+ Add Element</button>\n                        </div> \n                    </div>\n                </div>\n                \n            </div>\n            <a-button class="cpb-add-row" type="primary" @click.prevent="addNewRow">Add new row</a-button> \n        </div>\n    ',data:function(){return{data_type:""}},props:["element"],watch:{element:{handler:function(){},deep:!0}},methods:{addElement:function(e){this.$emit("addSubElementOfRepeater",e)},openSettingField:function(e){this.$emit("openSubElementSettingOfRepeater",e)},deleteElement:function(e,n){this.$emit("deleteSubElementOfRepeater",{elements:e,index:n})},getClassCol:function(e){var n=[];return"object"==_typeof(e.width)&&(n.push("cpb-md-"+e.width.md),n.push("cpb-sm-"+e.width.sm),n.push("cpb-xs-"+e.width.xs)),n.join(" ")},isShowAddElementButton:function(e){return 0===e.elements.length},addNewRow:function(){this.$emit("addNewRowRepeater",this.element.layout),0===this.element.rows_numb.value&&this.element.cols_numb.value++,console.log("cols",this.element.layout.rows),this.element.rows_numb.value++},deleteCol:function(e,n){e.splice(n,1);for(var t=0,o=0,l=0;l<this.element.layout.rows.length;l++)this.element.layout.rows[l].cols.length>t&&(t=this.element.layout.rows[l].cols.length),0!==this.element.layout.rows[l].cols.length&&o++;t!==parseInt(this.element.cols_numb.value)&&(this.element.cols_numb.value=t),o!==parseInt(this.element.rows_numb.value)&&(this.element.rows_numb.value=o)}},mounted:function(){}}),Vue.component("cp-builder",{props:{layouts:{type:Array,default:function(){return[]}},valiable_elements:{type:Array,default:function(){return[]}}},template:'\n        <div class="cpb-wrapper">\n            <div class="">\n                Responsive: \n                <a-radio-group class="" v-model="mode_design" buttonStyle="solid">\n                    <a-radio-button value="md">Desktop</a-radio-button>\n                    <a-radio-button value="sm">Table</a-radio-button>\n                    <a-radio-button value="xs">Mobile</a-radio-button>\n                </a-radio-group>\n            </div>\n\n            <div class="cpb-main" :class="\'cpb-resmode-\' + mode_design">\n                <div class="cpb-row cpb-row-blank" v-if="layouts.length == 0">\n                    <div class="cpb-blank">\n                        <div class="cpb-title">You have a blank page</div>\n                        <div class="cpb-subtitle" @click="addRow(3)"><a>Add new element or row/column layout</a></div>\n                    </div>\n                </div>\n                <draggable v-model="layouts" handle=".cpb-handle-sort">\n                    <div class="cpb-row" v-for="row, index in layouts" :key="index"> \n                        <div class="cpb-row-tools">\n                            <button class="cpb-handle-sort">Sort</button>\n                            <button @click.prevent="deleteRow(layouts, index)" class="cpb-handle-delete">Delete</button>\n                            <button @click.prevent="addCol(row)" class="cpb-handle-add">Add</button>\n                            <button @click.prevent="openSettingRow(row)" class="cpb-handle-setting">Setting</button>\n                            <a-switch v-model="row.active" />\n                        </div>\n\n                        <template v-if="row.active">\n                            <div class="cpb-col" :class="getClassCol(col)" v-for="col, indexcol in row.cols">\n                                <button v-cpbresizecol="{col:col, \'mode\': mode_design}" class="cob-resize-col"></button>\n                                <div class="cpb-entry">\n                                    <draggable class="list-group" :list="col.elements" group="elements_in_col">\n                                        <div v-for="element, index in col.elements" :key="element.name + index">\n                                            <div class="cpb-element-selected">\n                                                <a-button class="cpb-btn-component" @click.prevent="openSettingField(element)" :icon="element.icon" block>\n                                                    <b v-if="element.user_input === \'\'">{{ element.label }} </b>\n                                                    <b v-else>{{ element.user_input }} </b>\n                                                </a-button>\n                                                <div class="cpb-com-tools">\n                                                    <a @click.prevent="openSettingField(element)" class="cpb-icon-settings">Cài đặt</a>\n                                                    <a @click.prevent="deleteElement(col.elements, index)" class="cpb-icon-delete"> Xoá</a>\n                                                </div>\n                                            </div>\n                                            <cpb-repeater v-if="element.id == \'repeater\'" :key="element.name" :element="element.settings" \n                                                 @addSubElementOfRepeater="addSubElementHandler"\n                                                 @openSubElementSettingOfRepeater="openSubElementSettingHandler"\n                                                 @deleteSubElementOfRepeater="deleteSubElementHanlder"\n                                                 @addNewRowRepeater="addNewRowHandler"></cpb-repeater>\n                                        </div>\n                                    </draggable>\n                                    <button v-if="col.elements.length == 0" class="cpb-add-element" @click.prevent="addElement(col)">+ Add Element</button>\n                                    \n                                    <div class="cpb-tool-col">\n                                        <button class="cpb-delete-col" @click.prevent="deleteCol(row.cols, indexcol)">Delete this Col</button>\n                                        <button class="cpb-add-element mini" @click.prevent="addElement(col)">+ Add Element</button>\n                                    </div>\n                                    \n                                </div>\n                            </div>\n                        </template>\n                        <div class="cpb-md-12 cpb-sm-12 cpb-xs-12">\n                            <a-button class="cpb-add-row" type="primary" @click.prevent="addCol(row)">Add new col</a-button> \n                        </div>\n                        \n                    </div>\n                </draggable>\n            </div>\n\n            <div class="cpb-footer-toolbar">\n                <button @click.prevent="addRow(1)" class="cpb-btn-addcol cpb-1col btn btn-sm"><span class="cpb-fake-col"></span></button>\n                <button @click.prevent="addRow(2)" class="cpb-btn-addcol cpb-2col btn btn-sm"><span v-for="i in [1,2]" class="cpb-fake-col"></span></button>\n                <button @click.prevent="addRow(3)" class="cpb-btn-addcol cpb-3col btn btn-sm"><span v-for="i in [1,2,3]" class="cpb-fake-col"></span></button>\n                <button @click.prevent="addRow(4)" class="cpb-btn-addcol cpb-4col btn btn-sm"><span v-for="i in [1,2,3,4]" class="cpb-fake-col"></span></button>\n                <button @click.prevent="addRow(6)" class="cpb-btn-addcol cpb-6col btn btn-sm"><span v-for="i in [1,2,3,4,5,6]" class="cpb-fake-col"></span></button>\n            </div>\n\n            <!-- Templates -->\n                <a-modal\n                    class="cpb-popup"\n                    v-model="model_elements"\n                    title="Adding Element"\n                    onOk="pickElement"\n                >\n                    <template slot="footer">\n                        <a-button key="submit" type="danger"  @click.prevent="closeModelElement">\n                            Ok\n                        </a-button>\n                    </template>\n                    \n                    <div class="cpb-wrap-elements">\n                        <a-collapse accordion v-model="collapse_element">\n                            <a-collapse-panel v-for="field in field_category" :header="field" :key="field">\n                                <a-col class="cpb-wrap-btn-com" v-if="elm.category == field" v-for="elm, index in valiable_elements" :key="elm.name + index" >\n                                    <a-button v-if="elm != null && elm.is_hide != true"\n                                    class="cpb-btn-select-com"\n                                            @click.prevent="selectedElement(elm)">\n                                        <a-icon :type="typeof elm.icon != \'undefined\' ? elm.icon : \'form\'" ></a-icon>\n                                        {{ elm.label }}\n                                    </a-button>\n                                </a-col>\n                            </a-collapse-panel>\n                        </a-collapse>\n                    </div>\n                </a-modal>\n\n\n                <a-modal class="cpb-popup" width="800px" :title="\'Setting: \' + current_element.label" centered\n                    v-model="modelSettingElement" @ok="saveSettingElement">\n                    <div class="cpb-wrapsettings"> \n                        <cpb-popup-setting :named="named" :root="layouts" :current_element="current_element"\n                            :hideAdvance="hideAdvanceTab"\n                            :opened="modelSettingElement"\n                            @onColumnChanged="columnChangedHandler"\n                            @onRowChanged="rowChangedHandler"/>\n                    </div>\n\n                    <template slot="footer">\n                        <a-button key="submit" type="primary"  @click.prevent="modelSettingElement = false">Close</a-button>\n                    </template>\n\n                </a-modal>\n            <!-- /Templates -->\n<!--            <pre>{{ layouts }}</pre>-->\n        </div>\n    ',data:function(){return{model_elements:!1,current_col:{},current_element:{},mode_design:"md",modelSettingElement:!1,named:{},field_category:[],collapse_element:"",hideAdvanceTab:!1}},mixins:{},watch:{layouts:{handler:function(){this.layouts=cpb.apply_filters("cpb_data_layout_changed",this.layouts);var n=this;n.named={},n.layouts.some(function(e){e.cols.some(function(e){e.elements.some(function(e){n.named[e.hash]=e.name})})})},deep:!0}},mounted:function(){var e=this.valiable_elements,t=this;e.map(function(n){Object.keys(n.settings).map(function(e){n.settings[e]=t.re_formar_element(n.settings[e])}),t.field_category.indexOf(n.category)<0&&t.field_category.push(n.category)}),0<t.field_category.length&&(t.collapse_element=t.field_category[0])},methods:{re_formar_element:function(e){return Object.assign({category:"General",type:"input",value:"",label:"Label",placeholder:"",description:""},e)},saveSettingElement:function(){},openSettingRow:function(e){e=cpb.apply_filters("cpb_load_row_settings",e),this.current_element=e,this.modelSettingElement=!0},openSettingField:function(e,n){var t=1<arguments.length&&void 0!==n&&n;this.current_element=e,this.hideAdvanceTab=t,this.modelSettingElement=!0},addElement:function(e,n){var t=1<arguments.length&&void 0!==n&&n,o=this.valiable_elements.find(function(e){return"repeater"===e.id});o&&(o.is_hide=!!t),this.model_elements=!0,this.current_col=e},closeModelElement:function(){this.model_elements=!1},selectedElement:function(e){var n=JSON.parse(JSON.stringify(e));n=cpb.apply_filters("cpb_before_add_field",n);var t=this;"string"!=typeof n.hash&&(n.hash="_"+Math.random().toString(36).substr(2,9)),"string"!=typeof n.error_message&&(n.error_message=""),Object.keys(n.settings).map(function(e){n.settings[e]=t.re_formar_element(n.settings[e])});var o=moment().valueOf();n.name="_cpb_"+moment().valueOf(),n.field_name="_cpb_field_"+o,n.condition_settings.or[0].and[0].target="","date-time-picker"===n.id&&(n.settings.default.value=moment().format(n.settings.default.format)),this.current_col.elements.push(n),this.model_elements=!1,this.current_col={}},deleteRow:function(e,n){cpArrayFuncs.deleteByIndex(e,n)},deleteCol:function(e,n){cpArrayFuncs.deleteByIndex(e,n)},deleteElement:function(e,n){cpArrayFuncs.deleteByIndex(e,n)},getClassCol:function(e){var n=[];return"object"==_typeof(e.width)&&(n.push("cpb-md-"+e.width.md),n.push("cpb-sm-"+e.width.sm),n.push("cpb-xs-"+e.width.xs)),n.join(" ")},addCol:function(e){e.cols.push(this.generalCol(4))},addColByValue:function(e,n){var t=!0,o=!1,l=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;s.cols=[];for(var c=1;c<=n;c++)s.cols.push(this.generalCol(12/n))}}catch(e){o=!0,l=e}finally{try{!t&&i.return&&i.return()}finally{if(o)throw l}}},addRowByValue:function(e,n,t){if(e.length<n)for(var o=n-e.length,l=0;l<o;l++){for(var a={cols:[]},i=parseInt(t),s=1;s<=i;s++)a.cols.push(this.generalCol(12/i));e.push(a)}else{if(e.length===n)return;for(var c=0;c<e.length;c++)0===e[c].cols.length&&e.splice(c,1)}},addRow:function(e){var n={active:!0,type:"row",label:"Row",settings:{name:{type:"input",value:"15px",label:"Gutter",placeholder:"",description:""}},style:{},cols:[]};e=parseInt(e);for(var t=1;t<=e;t++)n.cols.push(this.generalCol(12/e));this.layouts.push(n)},generalCol:function(e,n,t){if(e=null==e?12:parseInt(e),null==n)switch(e){case 1:case 2:case 3:case 4:n=4;break;case 5:case 6:case 7:n=6;break;case 8:case 9:case 10:case 11:case 12:default:n=12}else n=parseInt(n);if(null==t)switch(n){case 1:case 2:case 3:t=4;break;case 4:case 5:case 6:t=6;break;case 7:case 8:case 9:case 10:case 11:case 12:t=12;break;default:n=12}else t=parseInt(t);return{type:"col",width:{md:e,sm:n,xs:t},settings:{},style:{},elements:[]}},addSubElementHandler:function(e){this.addElement(e,!0)},openSubElementSettingHandler:function(e){this.openSettingField(e,!0)},deleteSubElementHanlder:function(e){this.deleteElement(e.elements,e.index)},columnChangedHandler:function(e){this.addColByValue(e.rows,e.value)},rowChangedHandler:function(e){this.addRowByValue(e.rows,e.number_of_rows,e.number_of_cols,e.default_value_cols)},addNewRowHandler:function(e){for(var n=JSON.parse(JSON.stringify({cols:[]})),t=1;t<=1;t++)n.cols.push(this.generalCol(12));e.rows.push(n)}}}),Vue.component("cpb-group-selections",{props:{locations:{type:Object,default:function(){}},title:{type:String,default:function(){return""}},hooks:{type:Array,default:function(){return[]}},api_endpoint:{type:String,default:function(){return""}}},template:'\n        <div class="cpb-wrapper">\n            <div class="cpb-main-location" type="flex">\n                <div>\n                    <div class="ant-form-item-label">\n                        <label>Show this field at</label>\n                    </div>\n                    <div>\n                        <a-row :gutter="16" style="padding: 8px 0;">   \n                            <a-col :span="7">\n                               <a-select style="width: 100%;" :defaultValue="whereToShow[0]" v-model="locations.location.whereToShow">\n                                    <a-select-option v-for="(element, idx) in hooks" :value="element.value" :key="idx">\n                                        {{element.label}}\n                                    </a-select-option>\n                               </a-select>\n                            </a-col>\n                        </a-row>\n                        <div class="ant-form-item-label">\n                            <label>Show this field if</label>\n                        </div>\n                        <a-row :gutter="16" style="padding: 8px 0;">   \n                            <a-col :span="24">\n                                <a-row>\n                                    <div v-for="(or, orIndex) in locations.location.whenToShow.or" :key="orIndex">\n                                \n                                        <a-row :gutter="16" style="padding-bottom: 10px" v-for="(condition, andIndex) in or.and" :key="andIndex" v-if="or.and.length > 0">\n                                            <a-col :span="7">\n                                                <a-select style="width: 100%;" @select="(value) => { onSelectObjectToShow(value, condition) }" :defaultValue="objectToShow[0]" v-model="condition.target">\n                                                    <a-select-option v-for="(obj, idx) in objectToShowFilter" :key="idx" :value="obj">{{obj}}</a-select-option>\n                                                </a-select>\n                                            </a-col>\n                                            <a-col :span="12">\n                                                <a-tree-select\n                                                    style="width: 100%; box-shadow: none"\n                                                    treeCheckable\n                                                    allowClear\n                                                    :disabled="isDisableWhenToShow"\n                                                    :labelInValue="true"\n                                                    @keyup.native="(event) => { onWhenToShowSearch(event.target.value, condition.target) }"\n                                                    :dropdownStyle="{ maxHeight: \'400px\', overflow: \'auto\' }"\n                                                    :filterTreeNode="onFilterValue"\n                                                    :treeData="whenToShowData[condition.target]"\n                                                    placeholder="Click here to select options"\n                                                    searchPlaceholder=\'When to show\'\n                                                    @change="onWhenToShowSelected"\n                                                    v-model="isClearWhenToShow ? getModelWhenToShow(condition) : condition.label"\n                                                    :treeDefaultExpandAll="true"\n                                                    />\n                                            </a-col>\n                                            <a-col :span="3">\n                                                <a-button style="width: 100%;" @click.prevent="addAndCondition(orIndex)">And</a-button>\n                                            </a-col>\n                                            <a-col :span="2">\n                                                <a-button shape="circle" icon="minus" @click.prevent="onDeleted(orIndex, andIndex)"/>\n                                            </a-col>\n                                        </a-row>\n                                        <div class="ant-form-item-label" v-if="or.and.length > 0">\n                                            <label title="Field name">Or</label>\n                                        </div> \n                                    </div>\n                                </a-row>\n                                <a-row :gutter="16" style="padding-bottom: 10px">\n                                        <a-col :span="24">\n                                            <a-button @click.prevent="addOrCondition()">Add rule group</a-button>\n                                        </a-col>\n                                    </a-row>\n                            </a-col>\n                            \n                            \n                        </a-row>\n                        \n                    </div>\n                    \n                    \n                </div>\n            </div>\n        </div>\n        \n    ',data:function(){return{rows:1,api:this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/users_and_roles/all",selectedWhenToShow:{orId:null,andId:null,wtsId:null,value:null},timeoutInstanceOnSearch:null,timeoutInstanceOnFilter:null,isClearWhenToShow:!1,locationData:[],isSelectedLeaf:!1,isDisableWhenToShow:!1,pages:["Single Product","Checkout","My Account"],whereToShow:["Before Add to cart","After Add to cart"],objectToShow:["User","Category","Attribute"],whenToShowData:{User:[],Product:[],Category:[],Attribute:[]}}},mixins:{},methods:{addAndCondition:function(e){this.locations.location.whenToShow.or[e].and.push({target:"",value:[],id:[],label:[]})},addOrCondition:function(){var e=this.locations.location.whenToShow.or.length;this.locations.location.whenToShow.or.push({and:[]}),this.addAndCondition(e)},onSelectObjectToShow:function(n,e){var t=this;switch(this.isClearWhenToShow=!0,this.clearAllSelectedItems(e),n){case"User":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/users_and_roles/all";break;case"Category":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/categories/all";break;case"Attribute":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/attributes/all";break;case"Product":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/products/all"}this.fetchDataFromAPI(this.api).then(function(e){200==e.status&&(t.whenToShowData[n]=e.data)}).catch(function(e){t.$message.error("There was an error "+e.message),console.log(e)})},getModelWhenToShow:function(e){return this.isClearWhenToShow&&(this.isClearWhenToShow=!1,e.whenToShow=[]),e.whenToShow},fetchDataFromAPI:function(e){return new Promise(function(n,t){axios.get(e).then(function(e){n(e)}).catch(function(e){t(e)})})},onWhenToShowSelected:function(){this.filterWhenToShow(this.locations.location.whenToShow)},clearAllSelectedItems:function(e){e.value=[],e.label=[],e.id=[]},filterWhenToShow:function(e){e.or.forEach(function(e){e.and.forEach(function(e){var t=[],o=[];e.label.forEach(function(e){var n=e.value.toString().match(/^-{0,1}\d+$/);return n?t.push(e.value):o.push(e.value),!n}),e.id=t,e.value=o})})},onWhenToShowSearch:function(e,n){var t=this;0===e.length&&(e="all"),null!=this.timeoutInstanceOnSearch&&clearTimeout(this.timeoutInstanceOnSearch),this.timeoutInstanceOnSearch=setTimeout(function(e,n){switch(n){case"User":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/users_and_roles/"+e;break;case"Category":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/categories/"+e;break;case"Attribute":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/attributes/"+e;break;case"Product":this.api=this.api_endpoint+"/?rest_route=/acf_fw_form/api/v1/products/"+e}t.fetchDataFromAPI(this.api).then(function(e){200==e.status&&(t.whenToShowData[n]=e.data)}).catch(function(e){t.$message.error("There was an error "+e.message),console.log(e)})},500,e,n)},onFilterValue:function(){return!0},isInitialState:function(){return 0===this.locations.location.whenToShow.or.length||0===this.locations.location.whenToShow.or[0].and[0].label.length&&!0===this.locations.location.enabled},onDeleted:function(e,n){var t=this.locations.location.whenToShow.or[e];null!=t&&1<t.and.length?t.and.splice(n,1):this.locations.location.whenToShow.or.splice(e,1)}},computed:{objectToShowFilter:function(){var e=[];switch(this.title){case"Single Product":e=["User","Product","Category","Attribute"];break;case"Checkout":e=["User","Product"];break;case"My Account":e=["User"]}return this.objectToShow=e}},mounted:function(){var n=this;this.isInitialState()&&this.onDeleted(0,0),this.fetchDataFromAPI(this.api).then(function(e){200==e.status&&(n.whenToShowData.User=e.data)}).catch(function(e){n.$message.error("There was an error "+e.message),console.log(e)})}}),Vue.component("row-toggle-selections",{props:["title","locations","index","hooks","defaultToggle","api_endpoint"],template:'\n        <div>\n            <a-row :gutter="16">\n                <a-col :span="1" class="gutter-row">\n                    <a-switch @change=\'onChange\' :checked="checked" />\n                </a-col>\n                <a-col :span="4" class="gutter-row" style="margin-left: 25px">\n                    <h3>{{title}}</h3>\n                </a-col>\n            </a-row>\n            <input type="hidden" class="cpb-location-data" />\n            <div v-if="checked">\n                <div class="cpb-selections">                   \n                    <cpb-group-selections :api_endpoint="api_endpoint" :title="title" :locations="locations" :hooks="hooks"></cpb-group-selections>\n                </div>\n            </div>\n        </div>\n    ',data:function(){return{checked:!1}},methods:{onChange:function(e){this.checked=e,this.locations.location.enabled=e,this.$emit("onToggleChanged",{value:this.checked,index:this.index})},isContainedOldData:function(){return this.locations.location.enabled}},mounted:function(){(0===this.index&&this.defaultToggle||this.isContainedOldData())&&(this.checked=!0,this.locations.location.enabled=!0,this.$emit("onToggleChanged",{value:this.checked,index:this.index}))}}),Vue.component("cp-location-builder",{props:{locations:{type:Object,default:function(){}},hooks:{type:Object,default:function(){}},api_endpoint:{type:String,default:function(){return""}}},template:'\n        <div class="cpb-wrapper">\n            <div class="cpb-main-location" type="flex">\n                <div class="cpb-toggles" v-for="(title, index) in titles">\n                    <row-toggle-selections :key="index" :title="title" :index="index" \n                        @onToggleChanged="onToggleChangedHandler"\n                        :api_endpoint="api_endpoint"\n                        :defaultToggle="isAddNewLocation()"\n                        :locations="getLocationForIndex(index)" :hooks="getHookForIndex(index)"></row-toggle-selections>\n                </div>\n            </div>\n            <input type="hidden"\n                name="builder_location_single_product_data" id="builder_location_single_product_data" \n                v-model="JSON.stringify(defaultLocationDataForIndex(0, locations[\'single_product\'][\'location\']))"/>\n            <input type="hidden"\n                name="builder_location_checkout_data" id="builder_location_my_account_data" \n                v-model="JSON.stringify(defaultLocationDataForIndex(1, locations[\'checkout\'][\'location\']))"/>\n            <input type="hidden"\n                name="builder_location_my_account_data" id="builder_location_my_account_data" \n                v-model="JSON.stringify(defaultLocationDataForIndex(2, locations[\'my_account\'][\'location\']))"/>\n        </div>\n    ',data:function(){return{titles:["Single Product","Checkout","My Account"],indexToggledFor:[],single_product_data:[],my_account_data:[],checkout_data:[]}},mixins:{},methods:{getLocationForIndex:function(e){switch(e){case 0:return this.locations.single_product;case 1:return this.locations.checkout;case 2:return this.locations.my_account}},getHookForIndex:function(e){switch(e){case 0:return this.hooks.single_product;case 1:return this.hooks.checkout;case 2:return this.hooks.my_account}},pageToggledFor:function(e){return this.indexToggledFor.includes(e)},onToggleChangedHandler:function(e){var n=e.index;e.value?this.indexToggledFor.push(n):this.indexToggledFor=this.indexToggledFor.filter(function(e){return e!==n})},defaultLocationDataForIndex:function(e,n){return this.pageToggledFor(e)?n:[]},isAddNewLocation:function(){return!1===this.locations.single_product.location.enabled&&!1===this.locations.my_account.location.enabled&&!1===this.locations.checkout.location.enabled}},watch:{locations:{handler:function(){},deep:!0}},mounted:function(){}}),Vue.component("cp-steps",{props:["layouts","valiable_elements","locations","products","hooks","api_endpoint"],template:'\n        <div>\n            <a-steps :current="current" class="row">\n                <a-step class="col-md-3"  v-for="item in steps" :key="item.title" :title="item.title" />\n              \n                    <div class="col-md-5">\n                        <div class="steps-action">\n                            <a-button\n                            v-if="current < steps.length - 1"\n                            type="primary" @click="next">\n                            Next\n                            </a-button>\n                            \n                            <a-button\n                                v-if="current>0"\n                                style="margin-left: 8px"\n                                @click="prev">\n                                Previous\n                            </a-button>\n                      </div>\n                    \n                    </div>\n            </a-steps>\n            <div class="steps-content">\n                <cp-builder v-if="this.current == 0" :layouts="layouts" :valiable_elements="valiable_elements"></cp-builder>\n              \n                <div class="body-location-builder" v-else>\n                    <cp-location-builder :api_endpoint="api_endpoint" :locations="locations" :hooks="hooks"  @locationDataChange="onLocationDataChange"></cp-location-builder>\n                </div>\n            </div>\n            <input type="hidden" name="builder_data" id="builder_data" v-model="JSON.stringify(layouts)"/>\n          \n           \n          </div>\n    ',data:function(){return{current:0,steps:[{title:"Form Builder"},{title:"Location Builder"}],locationData:[]}},watch:{locations:{handler:function(){}},deep:!0},mixins:{},methods:{next:function(){this.current++},prev:function(){this.current--},onLocationDataChange:function(e){this.locationData=e}},mounted:function(){}});